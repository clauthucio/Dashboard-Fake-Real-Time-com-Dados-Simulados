@if (dashboardData$ | async; as data) {
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
  <!-- Peças Boas -->
  <div
    class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-3xl p-6 text-white shadow-lg relative overflow-hidden group"
  >
    <div class="relative z-10">
      <div class="flex justify-between items-start mb-4">
        <span class="text-blue-100 font-medium text-sm">Peças Boas</span>
        <div class="bg-white/20 p-2 rounded-lg backdrop-blur-sm">
          <z-icon zType="trending-up" class="w-4 h-4 text-white" />
        </div>
      </div>
      <div class="flex items-baseline gap-2">
        <h3 class="text-3xl font-bold">{{ data.pecasBoas | number }}</h3>
        <span class="text-blue-200 text-xs font-medium bg-blue-400/30 px-2 py-0.5 rounded-full"
          >{{ data.rateBoas | number : '1.2-2' }}%</span
        >
      </div>
    </div>
    <div
      class="absolute -right-6 -bottom-6 w-32 h-32 bg-white/10 rounded-full blur-2xl group-hover:scale-110 transition-transform duration-500"
    ></div>
  </div>

  <!-- Peças Ruins -->
  <div
    class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-3xl p-6 text-white shadow-lg relative overflow-hidden group"
  >
    <div class="relative z-10">
      <div class="flex justify-between items-start mb-4">
        <span class="text-gray-400 font-medium text-sm">Peças Ruins</span>
        <div class="bg-white/10 p-2 rounded-lg backdrop-blur-sm">
          <z-icon zType="trending-down" class="w-4 h-4 text-gray-400" />
        </div>
      </div>
      <div class="flex items-baseline gap-2">
        <h3 class="text-3xl font-bold">{{ data.pecasRuins | number }}</h3>
        <span class="text-gray-400 text-xs font-medium bg-gray-700/50 px-2 py-0.5 rounded-full"
          >{{ data.rateRuins | number : '1.2-2' }}%</span
        >
      </div>
    </div>
    <div
      class="absolute -right-6 -bottom-6 w-32 h-32 bg-white/5 rounded-full blur-2xl group-hover:scale-110 transition-transform duration-500"
    ></div>
  </div>

  <!-- Máquinas Online -->
  <div
    class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-3xl p-6 text-white shadow-lg relative overflow-hidden group"
  >
    <div class="relative z-10">
      <div class="flex justify-between items-start mb-4">
        <span class="text-blue-100 font-medium text-sm">Máquinas Online</span>
        <div class="bg-white/20 p-2 rounded-lg backdrop-blur-sm">
          <z-icon zType="clock" class="w-4 h-4 text-white" />
        </div>
      </div>
      <div class="flex items-baseline gap-2">
        <h3 class="text-3xl font-bold">{{ data.onlineCount | number }}</h3>
        <span class="text-blue-200 text-xs font-medium bg-blue-400/30 px-2 py-0.5 rounded-full"
          >{{ data.rateOnline | number : '1.1-1' }}%</span
        >
      </div>
    </div>
    <div
      class="absolute -right-6 -bottom-6 w-32 h-32 bg-white/10 rounded-full blur-2xl group-hover:scale-110 transition-transform duration-500"
    ></div>
  </div>

  <!-- Máquinas Paradas -->
  <div
    class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-3xl p-6 text-white shadow-lg relative overflow-hidden group"
  >
    <div class="relative z-10">
      <div class="flex justify-between items-start mb-4">
        <span class="text-gray-400 font-medium text-sm">Máquinas Paradas</span>
        <div class="bg-white/10 p-2 rounded-lg backdrop-blur-sm">
          <z-icon zType="circle-alert" class="w-4 h-4 text-gray-400" />
        </div>
      </div>
      <div class="flex items-baseline gap-2">
        <h3 class="text-3xl font-bold">{{ data.offlineCount | number }}</h3>
        <span class="text-gray-400 text-xs font-medium bg-gray-700/50 px-2 py-0.5 rounded-full"
          >{{ data.rateOffline | number : '1.1-1' }}%</span
        >
      </div>
    </div>
    <div
      class="absolute -right-6 -bottom-6 w-32 h-32 bg-white/5 rounded-full blur-2xl group-hover:scale-110 transition-transform duration-500"
    ></div>
  </div>
</div>

<!-- Charts Grid Row -->
<div class="grid grid-cols-1 lg:grid-cols-5 gap-6 mb-6">
  <!-- Main Production Chart (Left - Wider but reduced to 3/5) -->
  <div class="lg:col-span-3">
    <app-production-chart [machines]="data.machines" class="block h-full" />
  </div>

  <!-- Side Bar Charts (Right - Broader 2/5) -->
  <div class="lg:col-span-2">
    <app-machine-bar-charts [machines]="data.machines" class="block h-full" />
  </div>
</div>

<app-machine-realtime-metrics [machines]="data.machines" />

<app-machine-recent-history [machines]="data.machines" />
}
